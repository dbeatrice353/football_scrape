f = open('scraped_player_info/scraped_player_info.dat','r')
lines = f.readlines()
f.close()

lines = [line.strip().split('\t') for line in lines]
fields = list(set([line[1] for line in lines]))
fields.pop() # there was some stray html in there
players = list(set([line[0] for line in lines]))

error_count = 0
records = []
for player in players:
	record = [player]
	for field in fields:
		selection = [line for line in lines if line[1] == field and line[0] == player]
		if len(selection) == 1:
			value = selection[0][2]
			record.append(value)
		else:
			error_count += 1
	records.append(record)

f = open('output.dat','w')
for row in records:
	f.write('\t'.row + '\n')
f.close()
print error_count

	
		
